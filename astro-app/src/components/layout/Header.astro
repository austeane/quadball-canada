---
import LanguageSwitcher from "./LanguageSwitcher.astro";

interface Props {
  currentPath: string;
  alternate?: { en: string; fr: string };
}

const { currentPath, alternate } = Astro.props as Props;

const navItems = [
  { href: "/news/", label: "News" },
  { href: "/about/", label: "About" },
  { href: "/play/", label: "Play" },
  { href: "/events/", label: "Events" },
  { href: "/teams/", label: "Teams" },
];

function isActive(href: string) {
  if (!currentPath) return false;
  return currentPath === href || currentPath.startsWith(href);
}
---
<header class="site-header">
  <a class="site-header__title" href="/" aria-label="Quadball Canada â€” Home">
    <img src="/quadball-canada-logo.jpg" alt="Quadball Canada" class="logo" />
  </a>
  <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav">Menu</button>
  <nav id="site-nav" class="site-header__nav" aria-label="Primary">
    {navItems.map((item) => (
      <a href={item.href} aria-current={isActive(item.href) ? "page" : undefined}>{item.label}</a>
    ))}
    <a class="btn btn--primary" href="https://www.paypal.me/quidditchcanada" target="_blank" rel="noopener">Donate</a>
    <LanguageSwitcher currentPath={currentPath} alternate={alternate} />
  </nav>
  <script>
    const btn = document.querySelector('.nav-toggle');
    const nav = document.getElementById('site-nav');
    btn?.addEventListener('click', () => {
      const open = btn.getAttribute('aria-expanded') === 'true';
      btn.setAttribute('aria-expanded', String(!open));
      nav?.classList.toggle('open', !open);
    });
  </script>
</header>

<style>
  .site-header { display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 0; position: sticky; top: 0; backdrop-filter: saturate(140%) blur(8px); background: color-mix(in oklab, var(--bg) 80%, white 20%); z-index: 40; border-bottom: 1px solid var(--border); }
  .site-header__title {
    display: inline-flex;
    align-items: center;
    text-decoration: none;
  }
  .logo { height: 36px; width: auto; display: block; }
  .site-header__nav a { margin-left:16px; color: var(--brand-primary); text-decoration:none; font-weight:600; }
  .btn { display:inline-block; padding:.5rem .9rem; border-radius:6px; text-decoration:none; }
  .btn--primary { background: var(--brand-primary); color: #fff; }
  .nav-toggle { display:none; border:1px solid var(--border); border-radius:6px; padding:.45rem .7rem; background:#fff; }
  @media (max-width: 768px){
    .nav-toggle { display:block; }
    .site-header__nav { position:absolute; left:0; right:0; top:60px; padding:12px 20px; background:#fff; display:none; border-bottom:1px solid var(--border); }
    .site-header__nav.open { display:block; }
    .site-header__nav a { display:block; margin:12px 0; }
  }
</style>
